on_actions = {
	on_startup = {
		effect = {
			ATE = {
				if = {
					limit = {
						has_game_rule = {
							rule = ATE_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = ATE_ai_behavior_speaker
					}
					else = {
						random_list = {
							30 = { set_country_flag = ATE_ai_behavior_jaguar }
							30 = { set_country_flag = ATE_ai_behavior_speaker }
							30 = { set_country_flag = ATE_ai_behavior_eagle }
							10 = { set_country_flag = ATE_ai_behavior_kinkaid }
						}
					}
				}
			}

			DES = {
				if = {
					limit = {
						has_game_rule = {
							rule = DES_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = DES_ai_behavior_ncr
					}
					else = {
						random_list = {
							33 = { set_country_flag = DES_ai_behavior_nevada_pact }
							33 = { set_country_flag = DES_ai_behavior_bos }
							33 = { set_country_flag = DES_ai_behavior_ncr }
						}
					}
				}
			}

			ITZ = {
				if = {
					limit = {
						has_game_rule = {
							rule = ITZ_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = ITZ_ai_behavior_clara
					}
					else = {
						random_list = {
							33 = { set_country_flag = ITZ_ai_behavior_carlos }
							33 = { set_country_flag = ITZ_ai_behavior_clara }
							33 = { set_country_flag = ITZ_ai_behavior_kalomte }
						}
					}
				}
			}

			CAF = {
				if = {
					limit = {
						has_game_rule = {
							rule = CAF_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = CAF_ai_behavior_loyalty
					}
					else = {
						random_list = {
							50 = { set_country_flag = CAF_ai_behavior_loyalty }
							50 = { set_country_flag = CAF_ai_behavior_independence }
						}
					}
				}
			}

			FFI = {
				if = {
					limit = {
						has_game_rule = {
							rule = FFI_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = FFI_ai_behavior_el_santo
					}
					else = {
						random_list = {
							33 = { set_country_flag = FFI_ai_behavior_el_santo }
							33 = { set_country_flag = FFI_ai_behavior_blue_demon }
							33 = { set_country_flag = FFI_ai_behavior_mil_mascaras }
						}
					}
				}
			}

			KHA = {
				if = {
					limit = {
						has_game_rule = {
							rule = KHA_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = KHA_ai_behavior_papa
					}
					else = {
						random_list = {
							50 = { set_country_flag = KHA_ai_behavior_papa }
							50 = { set_country_flag = KHA_ai_behavior_regis }
						}
					}
				}
			}

			MOJ = {
				if = {
					limit = {
						has_game_rule = {
							rule = MOJ_status
							option = BLACK_MOUNTAIN
						}
					}
					573 = {
						add_core_of = UTO
						remove_core_of = MOJ
					}
					UTO = {
						transfer_state = 573
						setup_utobithan_military = yes
						# If we don't do this Utobitha ends up with this template for some
						# reason - glitchy base game behavior?
						delete_unit_template_and_units = {
							division_template = "Knight Patrol"
						}
						delete_unit_template_and_units = {
							division_template = "Paladin Patrol"
						}
						add_to_array = { GLOBAL.early_tagswitch_countries = UTO }
					}
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = MOJ_status
							option = UTOBITHA
						}
					}
					# If we don't do this Utobitha ends up with this template for some
					# reason - glitchy base game behavior?
					delete_unit_template_and_units = {
						division_template = "Knight Patrol"
					}
					delete_unit_template_and_units = {
						division_template = "Paladin Patrol"
					}
					become_utobitha = yes

					# Give folks another chance to become Utobitha if they misunderstood
					# how the rule worked.
					add_to_array = { GLOBAL.early_tagswitch_countries = UTO }
				}
				else = {
					# If we're not messing with Black Mountain load up the Mojave
					# Chapter's garrison for it.
					load_oob = MOJ_2275_black_mountain
				}
				if = {
					limit = {
						has_game_rule = {
							rule = MOJ_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = MOJ_ai_behavior_elijah
					}
					else = {
						random_list = {
							33 = { set_country_flag = MOJ_ai_behavior_elijah }
							33 = { set_country_flag = MOJ_ai_behavior_hardin }
							33 = { set_country_flag = MOJ_ai_behavior_mcnamara }
						}
					}
				}
			}

			NCR = {
				if = {
					limit = {
						has_game_rule = {
							rule = NCR_status
							option = BROKEN
						}
					}
					load_focus_tree = settler_generic
					set_cosmetic_tag = NCR_shady_sands
					load_oob = NCR_Broken_California_naval

					BAR = {
						release_from_prev = yes
						every_owned_state = {
							remove_core_of = NCR
						}
						load_oob = BAR_Broken_California
						load_oob = BAR_Broken_California_naval
						delete_unit_template_and_units = {
							division_template = "NCR Troopers"
						}
						delete_unit_template_and_units = {
							division_template = "NCR Rangers"
						}
						delete_unit_template_and_units = {
							division_template = "Motorized Division"
						}
					}

					BON = {
						release_from_prev = yes
						every_owned_state = {
							remove_core_of = NCR
						}
						load_oob = BON_Broken_California
						load_oob = BON_Broken_California_naval
						delete_unit_template_and_units = {
							division_template = "NCR Troopers"
						}
						delete_unit_template_and_units = {
							division_template = "NCR Rangers"
						}
						delete_unit_template_and_units = {
							division_template = "Motorized Division"
						}
					}

					every_owned_state = {
						limit = { is_dayglow_state = yes }
						DAY = { transfer_state = PREV }
						add_core_of = DAY
						remove_core_of = PREV
					}
					RAP = {
						every_owned_state = {
							DAY = { transfer_state = PREV }
							add_core_of = DAY
							remove_core_of = PREV
						}
					}
					DAY = {
						load_oob = DAY_Broken_California
						load_oob = DAY_Broken_California_naval
						delete_unit_template_and_units = {
							division_template = "NCR Troopers"
						}
						delete_unit_template_and_units = {
							division_template = "NCR Rangers"
						}
						delete_unit_template_and_units = {
							division_template = "Motorized Division"
						}
					}

					every_owned_state = {
						limit = { is_diablo_state = yes }
						BOS = { transfer_state = PREV }
						add_core_of = BOS
						remove_core_of = NCR
					}
					BOS = { load_oob = BOS_Diablo_Garrison }

					every_state = {
						limit = { is_expanded_san_francisco_state = yes }
						remove_core_of = OWNER
						SHI = { transfer_state = PREV }
						add_core_of = SHI
					}
					SHI = {
						load_oob = SHI_Broken_California
						load_oob = SHI_Broken_California_naval
					}

					every_state = {
						limit = { is_expanded_umbra_state = yes }
						remove_core_of = OWNER
						UMB = { transfer_state = PREV }
						add_core_of = UMB
					}
					UMB = {
						load_oob = UMB_Broken_California
						load_oob = UMB_Broken_California_naval
					}

					add_to_array = { GLOBAL.early_tagswitch_countries = BAR }
					add_to_array = { GLOBAL.early_tagswitch_countries = BON }
					add_to_array = { GLOBAL.early_tagswitch_countries = DAY }
					add_to_array = { GLOBAL.early_tagswitch_countries = NCR }
				}
				else = {
					BAR = { add_ideas = { currencyncrdollar } }
					BON = { add_ideas = { currencyncrdollar } }
					DAY = { add_ideas = { currencyncrdollar } }
					add_ideas = {
						undisturbed_isolation
						brahminbarons
						ncrguns
					}
					create_country_leader = {
						name = "Grant C. Hayes"
						desc = "Hayes_DESC"
						picture = "gfx/leaders/ENC/portrait_enc_hayes.dds"
						expire = "3000.1.1"
						ideology = ideocracy
					}
					create_country_leader = {
						name = "Allgood Murphy"
						desc = "Allgood_DESC"
						picture = "portrait_allgood.dds"
						expire = "3000.1.1"
						ideology = benevolent_dictatorship
					}
					create_country_leader = {
						name = "Anton Flynn"
						desc = "Anton_Flynn_DESC"
						picture = "portrait_flynn.dds"
						expire = "3000.1.1"
						ideology = conspiratory_oligarchy
					}
					add_equipment_to_stockpile = {
						type = convoy_1
						amount = 110
						producer = NCR
					}
					load_oob = NCR_2275_naval
					load_oob = NCR_BAR_2275
					load_oob = NCR_BAR_2275_naval
					load_oob = NCR_BON_2275
					load_oob = NCR_BON_2275_naval
					load_oob = NCR_DAY_2275
					load_oob = NCR_DAY_2275_naval
					load_oob = NCR_UMB_2275
					BOS = {
						load_oob = BOS_Navarro_Garrison
						load_oob = BOS_San_Francisco_Garrison
					}
					SCR = {
						load_oob = SCR_Extra_Garrison
					}
					SHI = {
						load_oob = SHI_2275_naval
					}
					UMB = {
						load_oob = UMB_2275_naval
					}
				}
			}

			NEW = {
				if = {
					limit = {
						has_game_rule = {
							rule = NEW_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = NEW_ai_behavior_ncr
					}
					else = {
						random_list = {
							20 = { set_country_flag = NEW_ai_behavior_neutrality }
							30 = { set_country_flag = NEW_ai_behavior_nevada_pact }
							30 = { set_country_flag = NEW_ai_behavior_ncr }
							10 = { set_country_flag = NEW_ai_behavior_enclave }
							10 = { set_country_flag = NEW_ai_behavior_thradd }
						}
					}
				}
			}

			EHT = {
				if = {
					limit = {
						has_game_rule = {
							rule = EHT_ai_behavior
							option = EHT_Nevada
						}
					}
					set_country_flag = eht_nevada
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = EHT_ai_behavior
							option = EHT_Terror
						}
					}
					set_country_flag = eht_terror
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = EHT_ai_behavior
							option = EHT_Mormon
						}
					}
					set_country_flag = eht_mormon
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = EHT_ai_behavior
							option = EHT_Legs
						}
					}
					set_country_flag = eht_legs
				}
				else = {
					random_list = {
						20 = {
							set_country_flag = eht_nevada
						}
						5 = {
							set_country_flag = eht_mormon
						}
						5 = {
							set_country_flag = eht_legs
						}
						70 = {
							set_country_flag = eht_terror #AI Eighties shouldn't be picking sides too often, makes the war too one-sided.
						}
					}
				}
			}

			WHT = {
				if = {
					limit = {
						has_game_rule = {
							rule = WHT_ai_behavior
							option = Claws
						}
					}
					set_country_flag = wht_monster
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = WHT_ai_behavior
							option = Mormon
						}
					}
					set_country_flag = wht_mormon
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = WHT_ai_behavior
							option = Legion
						}
					}
					set_country_flag = wht_legion
				}
				else = {
					random_list = {
						60 = {
							set_country_flag = wht_legion
							modifier = {
								factor = 0
								EHT = { has_country_flag = eht_legs }
							}
							modifier = {
								factor = 1.5
								EHT = { has_country_flag = eht_mormon }
							}
						}
						30 = {
							set_country_flag = wht_monster
						}
						10 = {
							set_country_flag = wht_mormon
							modifier = {
								factor = 0
								EHT = { has_country_flag = eht_legs }
							}
						}
						30 = {
							set_country_flag = eht_terror
						}
					}
				}
			}

			#Oregon RNG Set Up
			#Most of the time, Warren should just conquer everything
			#Sometimes however, you get different results.
			#The way this is encouraged is by assinging different focus paths here.
			if = {
				limit = {
					ERB = {
						is_ai = no
					}
				}
				BDT = {
					set_country_flag = bdt_aggressive_outlook_flag
					set_country_flag = bdt_road_warriors
				}
			}
			else = {
				if = {
					limit = {
						MLT = {
							is_ai = no
						}
					}
					DIS = {
						set_country_flag = DIS_mend_schism
					}
				}
				else = {
					random_list = {
						70 = {
							#Nothing!
						}
						30 = {
							set_country_flag = DIS_mend_schism
						}
					}
				}
				random_list = {
					80 = {
						#TRL annexes Oregon, as normal
						if = {
							limit = {
								TRL = { is_ai = yes } #Never do this vs the player, its mean
							}
							BDT = {
								#BDT is more likely to be aggressive with TRL then with MDT
								random_list = {
									80 = {
										set_country_flag = bdt_aggressive_outlook_flag
									}
									20 = {
										set_country_flag = bdt_diplomatic_outlook_flag
									}
								}
							}
						}
						else = {
							#Should be up to player in this case, so always send offer
							BDT = {
								set_country_flag = bdt_diplomatic_outlook_flag
							}
						}
					}
					20 = {
						#MDT goes down a early aggression route and quickly annexes TRL
						if = {
							limit = {
								TRL = { is_ai = yes } #Never do this vs the player, its mean
							}
							MDT = {
								set_country_flag = MDT_quick_aggression_flag
							}
							BDT = {
								#BDT is more likely to be diplomatic with MDT then with TRL
								random_list = {
									50 = {
										set_country_flag = bdt_aggressive_outlook_flag
									}
									50 = {
										set_country_flag = bdt_diplomatic_outlook_flag
									}
								}
							}
						}
						else = {
							#Should be up to player in this case, so always send offer
							BDT = {
								set_country_flag = bdt_diplomatic_outlook_flag
							}
						}
					}
				}
				BDT = {
					if = {
						limit = {
							has_country_flag = bdt_aggressive_outlook_flag
						}
						random_list = {
							50 = {
								set_country_flag = bdt_road_warriors
							}
							30 = {
								set_country_flag = bdt_seraph_lords
							}
							20 = {
								set_country_flag = bdt_odious_king
							}
						}
					}
					else = {
						random_list = {
							60 = {
								set_country_flag = bdt_seraph_lords
							}
							40 = {
								set_country_flag = bdt_odious_king
							}
						}
					}
				}
			}

			RRG = {
				if = {
					limit = {
						has_game_rule = {
							rule = RRG_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = RRG_ai_behavior_guerra
					}
					else = {
						random_list = {
							33 = { set_country_flag = RRG_ai_behavior_guerra }
							33 = { set_country_flag = RRG_ai_behavior_mora }
							33 = { set_country_flag = RRG_ai_behavior_rosado }
						}
					}
				}
			}

			TLA = {
				if = {
					limit = {
						has_game_rule = {
							rule = TLA_status
							option = CHILDREN
						}
					}

					# Make sure that Maximilian is a bit more popular, he's the canonical
					# choice for who is given Tlaloc's Lair.
					set_popularities = {
						ruler = 0
						people = 32
						elites = 33
						intellectuals = 35
					}
					ZAP = {
						set_tlaloc_children_tech_for_child_gamerule = yes
					}
					MOC = {
						set_tlaloc_children_tech_for_child_gamerule = yes
					}
					MAX = {
						set_tlaloc_children_tech_for_child_gamerule = yes
					}

					# Release the kids!
					tlaloc_child_army_variables = yes
					release_maximilian = yes
					release_moctezuma = yes
					release_zapata = yes

					# Give Tlaloc's Lair to Maximilian.
					769 = {
						remove_core_of = TLA
					}
					MAX = { transfer_state = 769 }

					# Give the Great Silo to Santa Anna for balance purposes.
					761 = {
						add_core_of = ARM
						remove_core_of = MAX
						remove_core_of = TLA
					}
					ARM = { transfer_state = 761 }

					add_to_array = { GLOBAL.early_tagswitch_countries = MAX }
					add_to_array = { GLOBAL.early_tagswitch_countries = MOC }
					add_to_array = { GLOBAL.early_tagswitch_countries = ZAP }
					every_state = {
						limit = {
							is_tlaloc_original_state = yes
						}
						remove_core_of = TLA
					}
				}
				else_if = {
					limit = {
						has_game_rule = {
							rule = TLA_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = TLA_ai_behavior_maximilian
					}
					else = {
						random_list = {
							33 = { set_country_flag = TLA_ai_behavior_maximilian }
							33 = { set_country_flag = TLA_ai_behavior_moctezuma }
							33 = { set_country_flag = TLA_ai_behavior_zapata }
						}
					}
				}
			}

			TDT = {
				if = {
					limit = {
						has_game_rule = {
							rule = TDT_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = TDT_ai_behavior_fox
					}
					else = {
						random_list = {
							50 = { set_country_flag = TDT_ai_behavior_fox }
							50 = { set_country_flag = TDT_ai_behavior_servant }
						}
					}
				}
			}

			VEG = {
				if = {
					limit = {
						has_game_rule = {
							rule = VEG_status
							option = BOOMERS
						}
					}
					154 = {
						add_core_of = BOO
						remove_core_of = VEG
					}
					BOO = {
						transfer_state = 154
						load_oob = vault_boomers
						# If we don't do this the Boomers end up with these templates for
						# some reason - glitchy base game behavior?
						delete_unit_template_and_units = {
							division_template = "Infantry Division"
						}
						delete_unit_template_and_units = {
							division_template = "Protectron Division"
						}
						delete_unit_template_and_units = {
							division_template = "Securitron Division"
						}
					}
					add_to_array = { GLOBAL.early_tagswitch_countries = BOO }
				}
				if = {
					limit = {
						has_game_rule = {
							rule = VEG_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = VEG_ai_behavior_ncr
					}
					else = {
						random_list = {
							25 = { set_country_flag = VEG_ai_behavior_house }
							25 = { set_country_flag = VEG_ai_behavior_joker }
							25 = { set_country_flag = VEG_ai_behavior_king }
							25 = { set_country_flag = VEG_ai_behavior_ncr }
						}
					}
				}
			}

			VLT = {
				if = {
					limit = {
						has_game_rule = {
							rule = VLT_ai_behavior
							option = DEFAULT
						}
					}
					if = {
						limit = { is_historical_focus_on = yes }
						set_country_flag = VLT_ai_behavior_lynette
					}
					else = {
						random_list = {
							25 = { set_country_flag = VLT_ai_behavior_the_brain }
							25 = { set_country_flag = VLT_ai_behavior_lynette }
							25 = { set_country_flag = VLT_ai_behavior_wallace }
							25 = { set_country_flag = VLT_ai_behavior_festus }
						}
					}
				}
			}

			# North Pole Enclave
			if = {
				limit = {
					has_game_rule = {
						rule = NPE_status
						option = ONMAP
					}
				}
				NPE = {
					transfer_state = 14
					transfer_state = 17
					transfer_state = 188
					transfer_state = 218
					transfer_state = 299
					transfer_state = 356
					transfer_state = 448
					transfer_state = 505
					transfer_state = 539
					every_owned_state = {
						limit = {
							NOT = {
								is_core_of = PREV
							}
						}
						add_core_of = NPE
						remove_core_of = var:original_owner
					}
					14 = {
						set_state_name = "STATE_SANTAS_WORKSHOP"
					}
					load_oob = "NPE_2275"
				}
				add_to_array = { GLOBAL.early_tagswitch_countries = NPE }
			}

			# Synthetic Dawn
			if = {
				limit = {
					has_game_rule = {
						rule = ITZ_synthetic_dawn
						option = ENABLED
					}
				}
				ITZ = { country_event = syntheticdawn.1 }
				TLA = { country_event = syntheticdawn.2 }
			}

			if = {
				limit = {
					has_game_rule = {
						rule = CLK_time_lords
						option = ENABLED
					}
				}
				CLK = { country_event = timelords.1 }
			}

			#Legion manpower rule
			if = {
				limit = {
					has_game_rule = {
						rule = CES_manpower
						option = ENABLED
					}
				}
				CES = {
					add_ideas = legion_gr_reduce_pop
				}
			}

			##########Legion Civil War###############
			if = {
				limit = {
					has_game_rule = {
						rule = CES_civil_war
						option = DISALLOWED
					}
				}
				CES = { set_global_flag = legion_civil_war_disabled }
			}

			##########Legion Explosion###############
			if = {
				limit = {
					has_game_rule = {
						rule = CES_legionsplosion
						option = DISABLED
					}
				}
				set_global_flag = legionsplosion_disabled
			}

			############NCR Civil War###############
			if = {
				limit = {
					OR = {
						has_game_rule = {
							rule = NCR_civil_war
							option = DISALLOWED
						}
						has_game_rule = {
							rule = NCR_status
							option = BROKEN
						}
					}
				}
				NCR = { set_global_flag = NCR_civil_war_disabled }
			}
		}
	}
}
# vim: set ft=pdx tw=79 :
